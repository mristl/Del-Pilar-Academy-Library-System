{% load static %}

<!doctype html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="{% static 'js/offline-handler.js' %}"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.ico' %}">

<style>
    body {
        background-color: #EFEFE9;
        font-family: "Poppins", sans-serif;
        margin: 0;
        padding: 0;
        display: flex;
        min-height: 100vh;
    }

    .sidenav {
        width: 220px;
        background-color: #0c2368;
        color: white;
        height: 100vh;
        padding: 20px;
        position: fixed;
        left: 0;
        top: 0;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .sidenav .logo-container {
        text-align: center;
        margin-bottom: 20px;
    }

    .sidenav img {
        width: 48%;
    }

    .sidebar a {
        color: white;
        text-decoration: none;
        padding: 10px 0;
        display: block;
        transition: background;
    }

    .sidebar a:hover {
        background-color: #5f6f52;
        border-radius: 5px;
    }

    .btn-secondary {
        background-color: #556a9d;
        color: white;
        border: #556a9d;
    }

    .btn-secondary:hover, .btn-secondary:focus, .btn-secondary:active {
        background-color: #36559c;
        color: white;
        text-align: center;
    }

    .btn-logout {
        padding: 7px 20px 10px 40px;
        border: 0;
        background-color: #0C2368;
        color: white;
        width: 80%;
        margin: 0 auto;
        cursor: pointer;
        text-decoration: underline;
    }

    .btn-logout:hover {
        color: rgb(167, 167, 167);
    }

    .card {
        padding: 20px;
        background-color: white;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
        text-align: center;
    }

    .sidenav {
        height: 100%;
        width: 210px;
        position: fixed;
        z-index: 1;
        top: 0;
        left: 0;
        background-color: #0c2368;
        overflow-x: hidden;
        padding-top: 30px;
        padding-left: 10px;
        display: flex;
        flex-direction: column;
        gap: 5px;
        align-items: start;
        font-size: 16px;
    }

    .sidenav-links {
        display: flex;
        flex-direction: column;
        flex-grow: 1; 
        justify-content: flex-end; 
        padding-bottom: 20px;
    }

    .sidenav a {
        color: white;
        text-decoration: none;
        padding-right: 5px;
        display: block;
        transition: background 0.2s;
        width: 100%; 
        box-sizing: border-box;
    }

    .sidenav a:hover {
        background-color: #032dad;
        transition: background-color 0.1s ease-in-out;
    }

    .headingFinal{
        padding: 20px 20px;
        position: absolute;
    }

    .headingFinalreport {
        padding: 20px 20px;
        position: absolute;
        margin-bottom: 80px;
    }

    .subheadingFinal {
        padding: 60px 20px;
        position: absolute;
        font-style: italic;
    }

    .middleCard{
        display: flex;
        height: calc(100vh - 60px);
        flex: 1; 
        margin-left: auto;
        margin-right: auto;
        align-items: center;
        justify-content: center;
        text-align: center;
    }

    .container {
        padding: 20px;
    }

    .main{
        margin-left: 15%;
        flex: 1;
        display: flex;
    }

    .dropdown {
        display: flex;
        flex-direction: column;
        width: 100%; 
        align-items: start;
    }

    .dropdown-btn {
        border: none;
        color: white;
        padding: 10px;
        text-align: left;
        width: 100%;
        cursor: pointer;
        font-size: 16px;
        display: flex;
        justify-content: flex-start;
        align-items: center;
    }

    .dropdown-btn i {
        margin-right: 0px;
    }

    .dropdown-container {
        display: none;
        flex-direction: column;
    }

    .dropdown-container a {
        padding: 5px 20px;
        display: block;
        text-decoration: none;
        color: white;
        transition: background 0.2s;
        width: 210px;
        margin-left: 20px;
    }

    .dropdown-container a:hover {
        background-color: #032dad;
        width: 95%;
        transition: 0.2s;
        padding: 10px 25px;
    }

    .dropdown-container.active {
        display: flex;
    }

    .sidenav a, .dropdown-btn {
        padding: 10px 20px;
        display: flex;
        align-items: center;
        width: 100%;
        box-sizing: border-box;
    }

    .menu-item {
        width: 100%;
    }

    .menu-item a, 
    .menu-item .dropdown-btn {
        display: flex;
        gap: 17px;
        width: 100%;
        color: white;
        text-align: left;
        border: none;
        background: none;
        cursor: pointer;
    }

    .menu-item .dropdown-btn {
        background: none;
        border: none;
        cursor: pointer;
    }

    .menu-item i {
        font-size: 16px;
        width: 20px;
        text-align: center;
    }

    .h5 {
    margin-top: 20%;
    }

    .dataTables_filter {
        display: none !important;
    }

    /* Style the table header */
    thead.table-dark th {
        text-align: center; /* Center text */
        font-size: 1rem; /* Adjust font size */
        padding: 12px; /* Add padding for better spacing */
        vertical-align: middle; /* Ensure vertical alignment */
    }

    /* Center table contents */
    #circulationTable td {
        text-align: center; /* Center text */
        vertical-align: middle; /* Align content properly */
        font-size: 1rem;
        padding: 10px;
        white-space: normal;
    }

    /* Ensure buttons remain tidy */
    #circulationTable button {
        padding: 6px 10px;
        font-size: 0.85rem;
    }

    /* Improve table layout */
    #circulationTable {
        width: 100%;
        border-collapse: collapse; /* Remove double borders */
    }

    /* Add subtle borders for better structure */
    #circulationTable th, #circulationTable td {
        border: 1px solid #ddd;
    }

    .no-click {
    pointer-events: none;
    cursor: default;
    }

    /* Custom modal styles */
    .modal-backdrop {
        opacity: 0.5 !important; /* Light opacity background */
    }
    
    .modal-dialog.modal-dialog-centered {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: calc(100% - 3.5rem);
    }
    
    /* Gray background for the flag confirmation modal */
    #flagConfirmModal .modal-content {
        background-color: #f0f0f0; /* Light gray background */
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        border: none;
    }
    
    /* Additional styling for the flag confirmation title and buttons */
    #flagConfirmModal .modal-header {
        background-color: #e0e0e0; /* Slightly darker gray for the header */
        border-bottom: 1px solid #d0d0d0;
    }
    
    #flagConfirmModal .modal-footer {
        background-color: #e0e0e0; /* Slightly darker gray for the footer */
        border-top: 1px solid #d0d0d0;
    }

    .dropdown-icon {
    margin-left: auto; /* optional, in case space-between isn't enough */
    }

    /* Add this to your existing styles */
    .messages-container {
        width: 100%;
        margin-bottom: 20px;
        margin-top: 0; /* Changed from 30px to 0 */
    }
    
    /* Your existing styles remain the same */
    .content-container {
        max-width: 700px;
        width: 100%;
        margin-left: auto;
        margin-right: auto;
        margin-top: 100px;
        padding: 20px;
        background: transparent;
    }

</style>
</head>

{%load static %}

<body>
    <div class="sidenav">
        <div class="logo-container">
            <img src="{% static '/images/DELPA.png' %}" alt="DelPA Logo">
            <h5>DelPA Library</h5>
        </div>
        
    

        <div class="menu-item dropdown">
            <button class="dropdown-btn">
                <i class="fa-solid fa-book"></i> Books 
                <i class="fa-solid fa-chevron-down dropdown-icon" style="align-items: right;"></i>
            </button>
            <div class="dropdown-container">
                <a href="{% url 'borrow_book' %}" >Borrow Books</a>
                <a href="{% url 'return_book' %}" >Return Books</a>
                <a href="{% url 'view_books' %}" >Circulation</a>
                <a href="{% url 'add_books' %}" >Add Books</a>
            </div>
        </div>      
        
        <div class="menu-item dropdown">
            <button class="dropdown-btn">
                <i class="fa-solid fa-user"></i> Library Users
                <i class="fa-solid fa-chevron-down dropdown-icon" style="align-items: right;"></i>
            </button>
            <div class="dropdown-container">
                <a href="{% url 'add_library_users' %}" >Add Library Users</a>
                <a href="{% url 'all_library_users' %}" >All Library Users</a>
            </div>
        </div>
        
        <div class="menu-item">
            <a href="{% url 'book_records' %}"><i class="fa-solid fa-folder"></i> Records</a>
        </div>
        
        <div class="menu-item">
            <a href="{% url 'reports' %}"><i class="fa-solid fa-file"></i> Reports</a>
        </div>     

        <div class="menu-item">
            <a href="{% url 'computer_use' %}"><i class="fa-solid fa-computer"></i> Computer Use</a>
        </div> 

        <div class="menu-item">
            <a href="{% url 'register' %}"><i class="fa-solid fa-user-plus"></i> Register Account</a>
        </div>
        
        <div class="menu-item">
            <a href="{% url 'backup' %}"><i class="fa-solid fa-cloud-upload-alt"></i> Backup</a>
        </div>  
        
        <div class="sidenav-links">
            <a href="{% url 'logout' %}" class="btn-logout">Logout</a>
        </div>

        <div class="menu-item">
            <a href="{% url 'overdue_simulation_tool' %}"><i class="fas fa-vial"></i> Overdue Sim Tool</a>
        </div>
        
    </div>

    <div class="main">
        {% block content %}
        {% endblock %}
    </div>


    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const dropdowns = document.querySelectorAll(".menu-item.dropdown");
    
            dropdowns.forEach((dropdown, index) => {
                const btn = dropdown.querySelector(".dropdown-btn");
                const container = dropdown.querySelector(".dropdown-container");
                const icon = dropdown.querySelector(".dropdown-icon");
    
                // Optional: restore state (per dropdown) from localStorage
                const storageKey = `dropdownOpen_${index}`;
                if (localStorage.getItem(storageKey) === "true") {
                    container.classList.add("active");
                    icon.classList.remove("fa-chevron-down");
                    icon.classList.add("fa-chevron-up");
                }
    
                btn.addEventListener("click", function (e) {
                    e.preventDefault(); // Prevent default link behavior (if any)
    
                    const isActive = container.classList.toggle("active");
    
                    if (isActive) {
                        icon.classList.remove("fa-chevron-down");
                        icon.classList.add("fa-chevron-up");
                        localStorage.setItem(storageKey, "true");
                    } else {
                        icon.classList.remove("fa-chevron-up");
                        icon.classList.add("fa-chevron-down");
                        localStorage.setItem(storageKey, "false");
                    }
                });
    
                // DO NOT collapse on link clicks inside the dropdown
                const links = container.querySelectorAll("a");
                links.forEach(link => {
                    link.addEventListener("click", function (e) {
                        // You can add logic here if needed, but we intentionally don't toggle the dropdown
                        // So it stays open after click
                    });
                });
            });
        });
    </script>
    
        
</body>
</html>

